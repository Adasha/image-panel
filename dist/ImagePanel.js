"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _createSuper(i){var a=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(i);return _possibleConstructorReturn(this,a?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _wrapNativeSuper(e){var i="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(e))return i.get(e);i.set(e,t)}function t(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(t,e)})(e)}function _construct(e,t,i){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,i){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return i&&_setPrototypeOf(r,i.prototype),r}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classPrivateMethodGet(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return i}function _classPrivateFieldGet(e,t){return _classApplyDescriptorGet(e,_classExtractFieldDescriptor(e,t,"get"))}function _classApplyDescriptorGet(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet(e,t,i){return _classApplyDescriptorSet(e,_classExtractFieldDescriptor(e,t,"set"),i),i}function _classExtractFieldDescriptor(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet(e,t,i){if(t.set)t.set.call(e,i);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=i}}var _shadow=new WeakMap,_imgLoader=new WeakMap,_imgArr=new WeakMap,_currImg=new WeakMap,_masterPath=new WeakMap,_defaultSlideInterval=new WeakMap,_defaultTransitionDuration=new WeakMap,_timer=new WeakMap,_slideInterval=new WeakMap,_transDur=new WeakMap,_slideTemplate=new WeakMap,_upgradeProperty=new WeakSet,_loadData=new WeakSet,_dataLoaded=new WeakSet,_dataLoadingFailed=new WeakSet,_slideLoaded=new WeakSet,_slideLoadingError=new WeakSet,ImagePanel=function(){_inherits(n,_wrapNativeSuper(HTMLElement));var s=_createSuper(n);function n(){var e;_classCallCheck(this,n);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];e=s.call.apply(s,[this].concat(i)),_slideLoadingError.add(_assertThisInitialized(e)),_slideLoaded.add(_assertThisInitialized(e)),_dataLoadingFailed.add(_assertThisInitialized(e)),_dataLoaded.add(_assertThisInitialized(e)),_loadData.add(_assertThisInitialized(e)),_upgradeProperty.add(_assertThisInitialized(e)),_shadow.set(_assertThisInitialized(e),{writable:!0,value:void 0}),_imgLoader.set(_assertThisInitialized(e),{writable:!0,value:new Image}),_imgArr.set(_assertThisInitialized(e),{writable:!0,value:void 0}),_currImg.set(_assertThisInitialized(e),{writable:!0,value:0}),_masterPath.set(_assertThisInitialized(e),{writable:!0,value:void 0}),_defaultSlideInterval.set(_assertThisInitialized(e),{writable:!0,value:6e3}),_defaultTransitionDuration.set(_assertThisInitialized(e),{writable:!0,value:0}),_timer.set(_assertThisInitialized(e),{writable:!0,value:void 0}),_slideInterval.set(_assertThisInitialized(e),{writable:!0,value:void 0}),_transDur.set(_assertThisInitialized(e),{writable:!0,value:void 0}),_slideTemplate.set(_assertThisInitialized(e),{writable:!0,value:void 0}),_classPrivateFieldSet(_assertThisInitialized(e),_shadow,e.attachShadow({mode:"closed"})),_classPrivateFieldGet(_assertThisInitialized(e),_imgLoader).addEventListener("load",_classPrivateMethodGet(_assertThisInitialized(e),_slideLoaded,_slideLoaded2).bind(_assertThisInitialized(e))),_classPrivateFieldGet(_assertThisInitialized(e),_imgLoader).addEventListener("error",_classPrivateMethodGet(_assertThisInitialized(e),_slideLoadingError,_slideLoadingError2).bind(_assertThisInitialized(e)));var r=document.createElement("style");return r.textContent="\n            :host {\n                display: block;\n                position: relative;\n                height: 100%;\n            }\n            :host > div {\n                background-size: cover;\n                background-position: center center;\n                background-repeat: no-repeat;\n                position: absolute;\n                top: 0;\n                right: 0;\n                bottom: 0;\n                left: 0;\n            }\n        ",_classPrivateFieldGet(_assertThisInitialized(e),_shadow).appendChild(r),_classPrivateFieldSet(_assertThisInitialized(e),_slideTemplate,document.createElement("div")),_classPrivateFieldGet(_assertThisInitialized(e),_slideTemplate).className="image-slide",e}return _createClass(n,[{key:"startSlideshow",value:function(e){this.loadSlide(e||0)}},{key:"stopSlideshow",value:function(){}},{key:"loadSlide",value:function(e){e=Utils.constrain(e,0,_classPrivateFieldGet(this,_imgArr).length-1);var t=_classPrivateFieldGet(this,_masterPath)+_classPrivateFieldGet(this,_imgArr)[e].src;_classPrivateFieldSet(this,_currImg,e),_classPrivateFieldGet(this,_imgLoader).src=t}},{key:"prevSlide",value:function(){_classPrivateFieldSet(this,_currImg,(_classPrivateFieldSet(this,_currImg,_classPrivateFieldGet(this,_currImg)-1)+_classPrivateFieldGet(this,_imgArr).length)%_classPrivateFieldGet(this,_imgArr).length),this.loadSlide(_classPrivateFieldGet(this,_currImg))}},{key:"nextSlide",value:function(){_classPrivateFieldSet(this,_currImg,_classPrivateFieldSet(this,_currImg,+_classPrivateFieldGet(this,_currImg)+1)%_classPrivateFieldGet(this,_imgArr).length),this.loadSlide(_classPrivateFieldGet(this,_currImg))}},{key:"pause",value:function(){_classPrivateFieldGet(this,_timer)&&_classPrivateFieldGet(this,_timer).pause()}},{key:"resume",value:function(){_classPrivateFieldGet(this,_timer)&&_classPrivateFieldGet(this,_timer).resume()}},{key:"connectedCallback",value:function(){}},{key:"disconnectedCallback",value:function(){}},{key:"attributeChangedCallback",value:function(e,t,i){switch(e){case"data":_classPrivateMethodGet(this,_loadData,_loadData2).call(this,i)}}},{key:"data",get:function(){return this.getAttribute("data")},set:function(e){this.setAttribute("data",e)}},{key:"width",get:function(){return this.getAttribute("width")},set:function(e){this.setAttribute("width",e)}},{key:"height",get:function(){return this.getAttribute("height")},set:function(e){this.setAttribute("height",e)}},{key:"interval",get:function(){return this.getAttribute("interval")},set:function(e){this.setAttribute("interval",e)}},{key:"fadeDuration",get:function(){return this.getAttribute("fade-duration")},set:function(e){this.setAttribute("fade-duration",e)}}],[{key:"observedAttributes",get:function(){return["data","width","height","interval","fade-duration"]}}]),n}();function _upgradeProperty2(e){var t;this.hasOwnProperty(e)&&(t=this[e],delete this[e],this[e]=t)}function _loadData2(e){var t=this,i=new XMLHttpRequest;i.onreadystatechange=function(){i.readyState===XMLHttpRequest.DONE&&(200===i.status?_classPrivateMethodGet(t,_dataLoaded,_dataLoaded2).call(t,JSON.parse(i.responseText)):_classPrivateMethodGet(t,_dataLoadingFailed,_dataLoadingFailed2).call(t,i))},i.open("GET",e,!0),i.send()}function _dataLoaded2(e){_classPrivateFieldSet(this,_imgArr,Array.isArray(e)?e:e.slides),_classPrivateFieldSet(this,_masterPath,e.masterPath||""),_classPrivateFieldSet(this,_slideInterval,e.slideInterval||_classPrivateFieldGet(this,_defaultSlideInterval)),_classPrivateFieldSet(this,_transDur,e.transitionDuration||_classPrivateFieldGet(this,_defaultTransitionDuration)),e.shuffleSlides&&Utils.shuffleArray(_classPrivateFieldGet(this,_imgArr)),this.startSlideshow()}function _dataLoadingFailed2(e){console.log("Data loading failed."),console.log(e)}function _slideLoaded2(e){var t=this,i=_classPrivateFieldGet(this,_shadow).querySelector("*.image-slide"),a=_classPrivateFieldGet(this,_slideTemplate).cloneNode(!0),r=_classPrivateFieldGet(this,_imgArr)[_classPrivateFieldGet(this,_currImg)];a.setAttribute("style",r.style||""),a.style.backgroundImage="url("+(_classPrivateFieldGet(this,_masterPath)+r.src)+")",i&&(i.style.zIndex="-1",a.style.zIndex="1"),_classPrivateFieldGet(this,_shadow).insertBefore(a,i),a.animate([{opacity:"0"},{opacity:"1"}],this.fadeDuration||_classPrivateFieldGet(this,_transDur)).addEventListener("finish",function(){i&&_classPrivateFieldGet(t,_shadow).removeChild(i),_classPrivateFieldSet(t,_timer,new Timer(t.nextSlide.bind(t),t.interval||_classPrivateFieldGet(t,_slideInterval)))})}function _slideLoadingError2(e){console.log('[ImagePanel.js] Image loading failed: "'+e.target.src+'"'),this.nextSlide()}customElements.define("image-panel",ImagePanel);var _timerID=new WeakMap,_start=new WeakMap,_remaining=new WeakMap,_callback=new WeakMap,Timer=function(){function i(e,t){_classCallCheck(this,i),_timerID.set(this,{writable:!0,value:void 0}),_start.set(this,{writable:!0,value:void 0}),_remaining.set(this,{writable:!0,value:void 0}),_callback.set(this,{writable:!0,value:void 0}),_classPrivateFieldSet(this,_callback,e),_classPrivateFieldSet(this,_remaining,t),this.resume()}return _createClass(i,[{key:"pause",value:function(){_classPrivateFieldGet(this,_timerID)&&(window.clearTimeout(_classPrivateFieldGet(this,_timerID)),_classPrivateFieldSet(this,_remaining,_classPrivateFieldGet(this,_remaining)-(new Date-_classPrivateFieldGet(this,_start))),_classPrivateFieldSet(this,_timerID,null))}},{key:"resume",value:function(){_classPrivateFieldGet(this,_timerID)&&window.clearTimeout(_classPrivateFieldGet(this,_timerID)),_classPrivateFieldSet(this,_start,new Date),_classPrivateFieldSet(this,_timerID,window.setTimeout(_classPrivateFieldGet(this,_callback),_classPrivateFieldGet(this,_remaining)))}}]),i}(),Utils=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"shuffleArray",value:function(e){for(var t,i,a=e.length-1;0<a;a--)t=Math.floor(Math.random()*(a+1)),i=e[a],e[a]=e[t],e[t]=i;return e}}]),e}();_defineProperty(Utils,"constrain",function(e,t,i){return"number"!=typeof e?NaN:(null!=t&&"number"==typeof t&&(e=Math.max(e,t)),null!=i&&"number"==typeof i&&(e=Math.min(e,i)),e)});